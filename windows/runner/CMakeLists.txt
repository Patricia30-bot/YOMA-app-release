cmake_minimum_required(VERSION 3.14)
project(YOMA LANGUAGES CXX)

# The name of the executable created for the app.
set(BINARY_NAME "YOMA")

# This value is used when the package is built and installed.
set(CMAKE_INSTALL_PREFIX "${CMAKE_CURRENT_BINARY_DIR}/install" CACHE PATH "")

# Define the build configuration
set(CMAKE_BUILD_TYPE "Release")

# Configure build to use C++17 (or higher, as required by Flutter)
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED YES)
set(CMAKE_CXX_EXTENSIONS NO)

# Flutter configuration
set(FLUTTER_MANAGED_DIR "${CMAKE_CURRENT_SOURCE_DIR}/flutter")
add_subdirectory(${FLUTTER_MANAGED_DIR})

# Application build
add_subdirectory("runner")

# Add plugins (auto-generated by Flutter)
include(flutter/generated_plugins.cmake)

# === Install step ===
install(
  DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/data"
  DESTINATION "data"
)

install(
  DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/assets"
  DESTINATION "data"
)

install(
  FILES "${CMAKE_CURRENT_SOURCE_DIR}/flutter/ephemeral/icudtl.dat"
  DESTINATION "data"
)

install(
  DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/flutter/ephemeral"
  DESTINATION "flutter_assets"
  USE_SOURCE_PERMISSIONS
)
